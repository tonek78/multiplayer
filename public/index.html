<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MultiTwitch - Advanced Stream Viewer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
    <!-- Twitch Embed Script -->
    <script src="https://embed.twitch.tv/embed/v1.js"></script>
</head>

<body>

    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <button class="sidebar-expand-btn hidden" id="expandSidebarBtn" title="Expand Sidebar">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </button>

    <div class="app-container">
        <!-- Sidebar / Control Panel -->
        <nav class="sidebar" id="sidebar">
            <div class="brand">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M21 10.5V3.75C21 3.33579 20.6642 3 20.25 3H3.75C3.33579 3 3 3.33579 3 3.75V20.25C3 20.6642 3.33579 21 3.75 21H13.5"
                        stroke="#a970ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M16.5 21V16.5H12V21" stroke="#a970ff" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M21 16.5V21H16.5" stroke="#a970ff" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M7.5 7.5H10.5V12H7.5" stroke="#a970ff" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M13.5 7.5H16.5V12H13.5" stroke="#a970ff" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
                <a href="/" class="brand-name"><span>MultiTwitch</span> </a>
                <button id="collapseSidebarBtn" class="icon-btn-small" title="Collapse Sidebar"
                    style="margin-left:auto;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
            </div>



            <div class="saved-groups-section" id="savedGroupsSection">
                <div class="section-header" onclick="app.toggleSection('savedGroupsList', this)">
                    <div style="display:flex; align-items:center; gap:5px;">
                        <span class="toggle-icon">▼</span>
                        <span data-i18n="savedGroups">Saved Groups</span>
                    </div>
                    <button id="saveGroupBtn" class="icon-btn-small" data-i18n-title="saveGroupBtn"
                        title="Save current group" onclick="event.stopPropagation()">+</button>
                </div>
                <div id="savedGroupsList" class="saved-groups-list">
                    <!-- Groups here -->
                </div>
            </div>

            <!-- New My Follows Section -->
            <div id="myFollowsSection" class="saved-groups-section hidden">
                <div class="section-header" onclick="app.toggleSection('myFollowsList', this)">
                    <div style="display:flex; align-items:center; gap:5px;">
                        <span class="toggle-icon">▼</span>
                        <span data-i18n="myFollows">My Follows</span>
                        <span id="myFollowsCount" style="font-size:0.8em; color:#666;"></span>
                    </div>
                </div>
                <!-- Search Input for Follows -->
                <div style="padding: 0 0.5rem 0.5rem 0.5rem;">
                    <input type="text" id="followsSearch" placeholder="Search follows..."
                        style="width:100%; background:rgba(255,255,255,0.05); border:1px solid #333; color:white; padding:4px 8px; border-radius:4px; font-size:0.8rem; outline:none;">
                </div>
                <div id="myFollowsList" class="saved-groups-list">
                    <!-- Live Follows here -->
                </div>
            </div>

            <div class="saved-groups-section"
                style="border-bottom:none; flex:1; display:flex; flex-direction:column; overflow:hidden;">
                <div class="section-header" onclick="app.toggleSection('activeStreamsList', this)">
                    <div style="display:flex; align-items:center; gap:5px;">
                        <span class="toggle-icon">▼</span>
                        <span>Active</span>
                    </div>
                </div>
                <div class="active-streams-list" id="activeStreamsList">
                    <!-- Streamers will be listed here -->
                </div>
            </div>

            <div class="sidebar-footer">
                <a href="/auth/twitch" id="loginBtn" class="icon-btn" title="Login with Twitch"
                    data-i18n-title="loginWithTwitch"
                    style="display:flex; align-items:center; justify-content:center; text-decoration:none;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                        <polyline points="10 17 15 12 10 7"></polyline>
                        <line x1="15" y1="12" x2="3" y2="12"></line>
                    </svg>
                </a>
                <a href="/auth/logout" id="logoutBtn" class="icon-btn hidden" title="Logout" data-i18n-title="logout"
                    style="display:flex; align-items:center; justify-content:center; text-decoration:none;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                </a>
                <button id="settingsBtn" class="icon-btn" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                </button>
                <button id="helpBtn" class="icon-btn" title="Útmutató">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </button>
                <button id="layoutToggle" class="icon-btn" title="Change Layout">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                </button>
                <button id="chatToggle" class="icon-btn active" title="Toggle Chat">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="top-bar">
                <div class="input-group-wrapper" style="position: relative;">
                    <div class="input-group">
                        <input type="text" id="streamInput" data-i18n-placeholder="addStreamerPlaceholder"
                            placeholder="Add streamer..." autocomplete="off">
                        <button id="addStreamBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                        <div id="searchResults" class="search-results hidden"></div>
                    </div>
                </div>
            </div>
            <div id="streamGrid" class="stream-grid">
                <!-- Streams will be injected here -->
                <div class="empty-state" id="emptyState">
                    <h2 data-i18n="welcomeTitle">Welcome to MultiTwitch</h2>
                    <p data-i18n="welcomeText">Add a streamer in the sidebar to get started.</p>
                </div>
            </div>
        </main>

        <!-- Chat Sidebar (Right) -->
        <aside class="chat-sidebar" id="chatSidebar">
            <div class="chat-header">
                <div id="chatTabs" class="chat-tabs">
                    <!-- Tabs will be injected here -->
                </div>
                <button id="closeChatBtn" class="icon-btn-small">✕</button>
            </div>
            <div id="chatContainer" class="chat-container">
                <!-- Chat Embed goes here -->
            </div>
        </aside>
    </div>

    <!-- Prompt Modal -->
    <div id="promptModal" class="modal-overlay">
        <div class="modal">
            <h3 class="modal-title" id="promptTitle">Enter Name</h3>
            <input type="text" id="promptInput" class="modal-input" placeholder="Type here..." autocomplete="off">
            <div class="modal-actions">
                <button id="promptCancel" class="modal-btn cancel">Cancel</button>
                <button id="promptOk" class="modal-btn delete" style="background:var(--accent)">Save</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="toast"></div>

    <div id="confirmModal" class="modal-overlay">
        <div class="modal">
            <h3 class="modal-title">Confirm Delete</h3>
            <p class="modal-message" id="confirmMessage">Are you sure you want to delete this group?</p>
            <div class="modal-actions">
                <button id="confirmCancel" class="modal-btn cancel" data-i18n="cancel">Cancel</button>
                <button id="confirmOk" class="modal-btn delete" data-i18n="delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Edit Group Modal -->
    <div id="editGroupModal" class="modal-overlay">
        <div class="modal" style="max-width: 500px;">
            <h3 class="modal-title" id="editGroupTitle">Edit Group</h3>

            <div class="input-group" style="margin-bottom: 1rem;">
                <input type="text" id="editGroupAddInput" class="modal-input" placeholder="Add streamer..."
                    style="margin-bottom:0">
                <button id="editGroupAddBtn" class="modal-btn"
                    style="background:var(--accent); color:white;">Add</button>
            </div>

            <div id="editGroupList" class="edit-group-list">
                <!-- Streamers list -->
            </div>

            <div class="modal-actions" style="margin-top: 1rem;">
                <button id="editGroupCancel" class="modal-btn cancel" data-i18n="cancel">Cancel</button>
                <button id="editGroupSave" class="modal-btn" style="background:var(--accent); color:white;"
                    data-i18n="saveChanges">Save
                    Changes</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal">
            <h3 class="modal-title" data-i18n="settingsTitle">Settings</h3>

            <div style="margin-bottom: 1.5rem;">
                <label style="display:block; margin-bottom:0.5rem; color:var(--text-secondary);"
                    data-i18n="language">Language</label>
                <select id="settingLanguage" class="modal-input"
                    style="width:100%; border:1px solid #333; background:#222; color:white; padding:0.5rem; border-radius:4px;">
                    <option value="hu">Magyar</option>
                    <option value="en">English</option>
                </select>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <label style="display:block; margin-bottom:0.5rem; color:var(--text-secondary);"
                    data-i18n="themeColor">Theme Color</label>
                <div class="color-swatches">
                    <button class="color-swatch active" data-color="#9146FF" style="background:#9146FF"></button>
                    <button class="color-swatch" data-color="#3b82f6" style="background:#3b82f6"></button>
                    <button class="color-swatch" data-color="#10b981" style="background:#10b981"></button>
                    <button class="color-swatch" data-color="#ef4444" style="background:#ef4444"></button>
                    <button class="color-swatch" data-color="#f59e0b" style="background:#f59e0b"></button>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <label class="checkbox-container">
                    <input type="checkbox" id="settingMuted">
                    <span class="checkmark"></span>
                    <span data-i18n="startMuted">Start streams muted</span>
                </label>
                <label class="checkbox-container" style="margin-top:10px;">
                    <input type="checkbox" id="settingNotifications">
                    <span class="checkmark"></span>
                    <span>Enable Live Notifications</span>
                </label>
            </div>

            <div style="margin-bottom: 1.5rem; border-top: 1px solid #333; padding-top: 1rem;">
                <label style="display:block; margin-bottom:0.5rem; color:var(--text-secondary);">Data Management</label>
                <div style="display:flex; gap:10px;">
                    <button id="exportBtn" class="modal-btn" style="background:#444; color:white; flex:1;">Export
                        Data</button>
                    <button id="importBtnTrigger" class="modal-btn" style="background:#444; color:white; flex:1;">Import
                        Data</button>
                    <input type="file" id="importFile" accept=".json" style="display:none;">
                </div>
            </div>

            <div class="modal-actions">
                <button id="settingsCancel" class="modal-btn cancel" data-i18n="cancel">Cancel</button>
                <button id="settingsSave" class="modal-btn" style="background:var(--accent); color:white;"
                    data-i18n="save">Save</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal-overlay">
        <div class="modal" style="max-width: 500px;">
            <h3 class="modal-title" data-i18n="helpTitle">Használati Útmutató</h3>

            <div style="margin-bottom: 1.5rem; color: var(--text-secondary); font-size: 0.95rem;">
                <p style="margin-bottom: 0.75rem;" data-i18n="helpIntro">
                    Üdvözöllek a MultiTwitch-en! Ezzel az alkalmazással egyszerre több streamet is nézhetsz,
                    chatelhetsz, és elmentheted a kedvenc csoportjaidat.
                </p>

                <h4 style="color:white; margin:1rem 0 0.5rem 0;" data-i18n="howToAdd">Hogyan adj hozzá streamet?</h4>
                <ul style="padding-left: 1.2rem; line-height: 1.5;" data-i18n="howToAddList">
                    <li>Írd be a streamer nevét (pl. <b>riotgames</b>)</li>
                    <li>YouTube link (pl. <b>youtube.com/watch?v=...</b>)</li>
                    <li>Kick link (pl. <b>kick.com/xqc</b>)</li>
                </ul>

                <h4 style="color:white; margin:1rem 0 0.5rem 0;" data-i18n="minFeatures">Funkciók</h4>
                <ul style="padding-left: 1.2rem; line-height: 1.5;" data-i18n="featuresList">
                    <li><b>Mentett Csoportok (+):</b> Mentsd el a jelenleg megnyitott streameket.</li>
                    <li><b>Beállítások (⚙️):</b> Válts színtémát vagy némítsd le az összeset.</li>
                    <li><b>Chat:</b> A jobb oldali panelen válthatsz a csevegések között.</li>
                </ul>
            </div>

            <div class="modal-actions">
                <button id="helpClose" class="modal-btn" style="background:var(--accent); color:white;"
                    data-i18n="understood">Értem</button>
            </div>
        </div>
    </div>

    <script src="/script.js"></script>
</body>

</html>